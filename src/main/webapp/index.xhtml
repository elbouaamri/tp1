<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <h:outputStylesheet name="css/mycsslayout.css"/>
    <h:outputScript name="js/script.js" target="head"/>
    <title>Conversation</title>
</h:head>

<h:body>
    <f:view>

        <!-- Affichage des messages d'erreur globaux -->
        <h:messages errorStyle="color: red" showDetail="true" showSummary="false" globalOnly="true"/>

        <h:form id="form">

            <!-- S√©lection du r√¥le de l'API -->
            <p:outputLabel for="rolesysteme" value="R√¥le de l'API : "/>
            <p:selectOneMenu id="rolesysteme" value="#{bb.roleSysteme}" editable="true"
                             required="true" requiredMessage="Vous devez indiquer le r√¥le de l'API"
                             disabled="#{! bb.roleSystemeChangeable}">
                <f:selectItems value="#{bb.rolesSysteme}"/>
            </p:selectOneMenu>
            <h:message for="rolesysteme" errorStyle="color: red" />

            <h:outputText value="  "/>
            <h:commandButton value="Nouveau chat" action="#{bb.nouveauChat}" />

            <!-- Mise en page principale -->
            <h:panelGrid id="paneltotal" columns="2" columnClasses="topAligned,topAligned">

                <!-- Colonne gauche : question et r√©ponse -->
                <h:panelGrid id="panelgauche" columns="1">
                    <h:panelGrid id="questionetreponse" columns="1">
                        <h:panelGroup>
                            <h:outputText value="Question :"/>
                            <button type="button" onclick="copyToClipboard('question')">Copier question</button>
                            <button type="button" onclick="toutEffacer()">Effacer question et r√©ponse</button>
                        </h:panelGroup>

                        <h:inputTextarea id="question" value="#{bb.question}" title="Question"
                                         cols="50" rows="5"/>
                        <h:commandButton value="Envoyer la question" action="#{bb.envoyer}"/>

                        <h:panelGroup>
                            <h:outputText value="R√©ponse :"/>
                            <button type="button" onclick="copyToClipboard('reponse')">Copier r√©ponse</button>
                        </h:panelGroup>

                        <h:inputTextarea id="reponse" value="#{bb.reponse}" title="R√©ponse"
                                         cols="50" rows="15"/>
                    </h:panelGrid>
                </h:panelGrid>

                <!-- Colonne droite : conversation -->
                <h:panelGrid id="paneldroit" columns="1" style="vertical-align: top;">
                    <h:panelGroup>
                        <h:outputText value="Conversation :"/>
                        <button type="button" onclick="copyToClipboard('conversation')">Copier conversation</button>
                    </h:panelGroup>
                    <h:inputTextarea id="conversation" rows="30" cols="50" readonly="true"
                                     value="#{bb.conversation}" title="Conversation enti√®re"/>
                </h:panelGrid>

            </h:panelGrid>
        </h:form>

        <!-- üîπ Partie Debug JSON (affich√©e si bb.debug = true) -->
        <h:panelGrid id="paneldebug" columns="1" rendered="#{bb.debug}" style="margin-top:30px;">
            <h:panelGroup>
                <h:outputText value="JSON envoy√© dans la requ√™te :"/>
                <button type="button" onclick="copyToClipboard('jsonrequete')">Copier requ√™te JSON</button>
            </h:panelGroup>
            <h:inputTextarea id="jsonrequete" value="#{bb.texteRequeteJson}" title="Requ√™te JSON"
                             cols="80" rows="10" readonly="true"/>

            <h:panelGroup>
                <h:outputText value="JSON retourn√© dans la r√©ponse :"/>
                <button type="button" onclick="copyToClipboard('jsonreponse')">Copier r√©ponse JSON</button>
            </h:panelGroup>
            <h:inputTextarea id="jsonreponse" value="#{bb.texteReponseJson}" title="R√©ponse JSON"
                             cols="80" rows="10" readonly="true"/>
        </h:panelGrid>

    </f:view>
</h:body>
</html>
